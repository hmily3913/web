<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN""http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<head>
<TITLE>欢迎进入系统后台</TITLE>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8" />
<link rel="stylesheet" href="../Images/CssAdmin.css">
<link rel="stylesheet" href="../Images/flexigrid.bbit.css">
<script language="javascript" src="../Script/Admin.js"></script>
<script language="javascript" src="../Script/jquery-1.5.2.min.js"></script>
<script language="javascript" src="../Script/flexigrid.pack.js"></script>
<script language="javascript" src="../Script/jquery.form.js"></script>
<script language="javascript" src="../Script/jquery.easydrag.js"></script>
<style type="text/css">
html{
margin:0;
padding:0;
background-color:#333;
font: 12px Arial, Helvetica, sans-serif;}
body{
margin:0 auto 0 auto;
padding:20px;
background-color:#eee;}
h1{margin-top:-10px;}
hr{margin:20px 0;}
</style>
</head>
<body>
<table width="100%">
  <tr>
	<td width="60px">年份:</td>
	<td width="60px">
	<select id="FYear" name="FYear">
	<option value="2011">2011</option>
	<option value="2012">2012</option>
	<option value="2013">2013</option>
	</select>
	</td>
	<td width="60px">月份:</td>
	<td width="60px">
	<select id="FMonth" name="FMonth">
	<option value="1">01</option>
	<option value="2">02</option>
	<option value="3">03</option>
	<option value="4">04</option>
	<option value="5">05</option>
	<option value="6">06</option>
	<option value="7">07</option>
	<option value="8">08</option>
	<option value="9">09</option>
	<option value="10">10</option>
	<option value="11">11</option>
	<option value="12">12</option>
	</select>
	</td>
	<td nowrap="nowrap"></td>
	</tr>
</table>
<table id="flex1" style="display:none"></table>
<script language="javascript">
$(function(){
	$('#addDiv').easydrag(); 
	$("#addDiv").setHandler("formove"); 
});
$("#flex1").flexigrid
	(
	{
	url: 'SupplyQCSortDetails.asp?showType=DetailsList',
	dataType: 'json',
	colModel : [
	{display: '序号', name : 'n0', width : 40, sortable : true, align: 'left'},
	{display: '供应商名称', name : 'n1', width : 120, sortable : true, align: 'left'},
	{display: '供应商编号', name : 'n2', width : 80, sortable : true, align: 'left'},
	{display: '检验总批次', name : 'n3', width : 80, sortable : true, align: 'left'},
	{display: '合格批次', name : 'n4', width : 60, sortable : true, align: 'left'},
	{display: '不合格批次', name : 'n5', width : 60, sortable : true, align: 'left'},
	{display: '合格率', name : 'n6', width : 60, sortable : true, align: 'left'},
	{display: '排名', name : 'n7', width : 50, sortable : true, align: 'left'}
		],
	buttons : [
		{name: '查询',  onpress : test},
		{separator: true},
		{name: '分析',  onpress : test},
		{separator: true}
		],
	striped:false,//
	usepager:false,
	autoload: false,
	title: '供方来料品质名次',
	showTableToggleBtn: true,
	width:'100%',
	height: 450
	}
	);
	
	function test(com,grid)
	{
		if (com=='分析')
			{
				$('#AddForm').resetForm();
				$.get("SupplyQCSortDetails.asp", { showType: "getInfo",FMonth: $('#FMonth').val(), FYear: $('#FYear').val()},
					 function(data){
							 var datajson=jQuery.parseJSON(data);//转换后的JSON对象
							 $(':input',$('#AddForm')).each(function(i,fieldone){
								 if(fieldone.id){
									 if(datajson.fieldValue[0][fieldone.id])
										 $('#'+fieldone.id).val(datajson.fieldValue[0][fieldone.id]);
							 }
							 });
					 });
				$("#addDiv").show("slow");
				$('select').hide('fast');
			}			
		else if (com=='查询')
			{
				$("#flex1").flexOptions({newp: 1, params:[
					{name:"FYear",value:$('#FYear').val()},
					{name:"FMonth",value:$('#FMonth').val()}]
				});
				$("#flex1").flexReload();
			}			
	}
function closead1(){
  $("#addDiv").hide("slow");
	$('select').show('fast');
}
function toSubmit(){
  $.post('SupplyQCSortDetails.asp?showType=DataProcess',
	 {
	  FYear: $('#FYear').val(),
		FMonth:$('#FMonth').val(),
		ReplyText:$('#ReplyText').val()
	 }
	 ,function(data){
    alert(data);
  });
}
</script>
<div id="addDiv" style="width:96%;height:'420px';top:0;left:20;display:none;background-color:#888888;position:absolute;marginTop:-75px;marginLeft:-150px;overflow-y: hidden; overflow-x: hidden;">
 <form id="AddForm" name="AddForm">
<table width="100%" border="0" cellpadding="3" cellspacing="1" bgcolor="#99BBE8">
  <tr>
    <td height="20" width="100%" class="tablemenu" id="formove"><font color="#15428B"><img src="../images/close.jpg" border="0" align="absmiddle" onClick="javascript:closead1()" >&nbsp;<strong>供方来料品质名次分析</strong></font></td>
  </tr>
  <tr>
    <td height="20" nowrap bgcolor="#EBF2F9">
	  <table width="100%" border="0" cellpadding="0" cellspacing="0" id=editNews>
      <tr>
        <td height="210" align="left" width="60">分析：</td>
        <td colspan="3">
	  <textarea name="ReplyText" id="ReplyText" style="width:95%; height:200px; "></textarea>
	  </td>
      </tr>
      <tr >
        <td height="20" align="left">分析人：</td>
        <td width="20%"><input name="Biller" type="text" class="textfield" id="Biller" value="" maxlength="100" readonly="true"></td>
        <td height="20" align="left" width="60">分析时间：</td>
        <td><input name="BillDate" type="text" class="textfield" id="BillDate" value="" readonly="true"></td>
      </tr>
	<tr bgcolor="#99BBE8">
	  <td align="center" colspan="4">
			<input name="submitSaveAdd" type="button" class="button"  value="保存" style="WIDTH: 80;"  onClick="toSubmit(this)">&nbsp;
			<input type="button" class="button"  value="关闭" style="WIDTH: 80;"  onClick="closead1()">&nbsp;
	  </td>
	</tr>
	</table>
	</td>
  </tr>
</table>
</form>
</div>
</BODY>
</HTML>